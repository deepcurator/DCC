since multiple templates can match a set of reactants, another model is trained to filter candidate products using standard supervised approaches.