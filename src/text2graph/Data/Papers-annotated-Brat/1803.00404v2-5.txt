the whole optimization problem is solved just like training a recursive network.