this framework is fully differentiable and can be trained in a purely data driven fashion by gradient methods.