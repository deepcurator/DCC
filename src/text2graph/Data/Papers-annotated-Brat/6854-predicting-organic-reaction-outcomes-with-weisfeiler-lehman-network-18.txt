the state-of-the-art solution is based on reaction templates (figure 1) .