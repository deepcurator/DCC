this batching task is generally difficult, but it becomes a major hurdle as architectures become complex.