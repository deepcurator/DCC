a direct solution would require o(n 3 ) operations.