# Whole Graph Embeddings using GCNs
The key idea is to embed, using GCNs, the code2graph rdf graphs generated by UCI to show code similarity. GCNs can take multiple graphs with node attributes and do whole-graph embeddings. Here is a discussion and diagram taken from the original GCN implementation (https://github.com/tkipf/gcn/issues/4) showing how to do it:
![foo](https://user-images.githubusercontent.com/7347296/34198790-eb5bec96-e56b-11e7-90d5-157800e042de.png)

The graph_generator.py load_data() formats the UCI_TF_Papers dataset according to this specification for batch-wise training over multiple graph instances of different sizes.

## Requirements
1. gcn https://github.com/tkipf/gcn/tree/master/gcn
2. gae https://github.com/tkipf/gae

## Dataset
1. Uncompress UCI_TF_Papers/rdf_triples to the DCC/src/code2graph/core/gcn directory.
2. I have created labels.csv for the UCI_TF_Papers/rtf_triples consisting of 10 labels (ML, NLP, GAN, ...).
3. I have created labels2.csv for the same dataset consisting of 4 labels.

## Embedding
Using plain GCN: 

```
python gcn_train.py
```

Using GAE: 
```
python gae_train.py
```

## TODO
For GCN we need to get to the embeddings. For GAE we need to do whole graph embedding instead of link prediction.

## Example output from GAE

